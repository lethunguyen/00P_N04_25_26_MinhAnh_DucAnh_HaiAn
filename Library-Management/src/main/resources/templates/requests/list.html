<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8"/><title>Borrow Requests</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body>
  <div th:replace="fragments/header :: header"></div>

  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2>ðŸ“– Borrow Requests</h2>
      <a th:href="@{/requests/new}" class="btn btn-primary">âž• Create New Request</a>
    </div>

    <table class="table table-bordered">
      <thead><tr><th>ID</th><th>Book</th><th>Customer</th><th>Status</th><th>Request Date</th><th>Return Date</th><th>Actions</th></tr></thead>
      <tbody>
        <tr th:each="req : ${requests}">
          <td th:text="${req.id}"></td>
          <td th:text="${req.book != null ? req.book.title : 'â€”'}"></td>
          <td th:text="${req.customer != null ? req.customer.fullName : 'â€”'}"></td>
          <td th:text="${req.status}"></td>
          <td th:text="${req.requestDate}"></td>
          <td th:text="${req.returnDate}"></td>
          <td>
            <a th:href="@{'/requests/approve/' + ${req.id}}" class="btn btn-sm btn-success" th:if="${req.status == 'PENDING'}">Approve</a>
            <a th:href="@{'/requests/return/' + ${req.id}}" class="btn btn-sm btn-info" th:if="${req.status == 'APPROVED'}">Mark Return</a>
            <a th:href="@{'/requests/delete/' + ${req.id}}" class="btn btn-sm btn-danger">Delete</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</body>
</html>
